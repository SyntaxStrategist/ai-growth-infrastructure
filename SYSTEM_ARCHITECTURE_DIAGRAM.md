# ๐๏ธ Avenir AI Solutions โ System Architecture

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         AVENIR AI SOLUTIONS                                   โ
โ                    Complete System Architecture                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              PUBLIC ROUTES                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                             โ
โ  /[en|fr]                          โ Landing Page (Marketing)              โ
โ  /[en|fr]/client/signup            โ Client Registration Form              โ
โ  /[en|fr]/client/dashboard         โ Client Login + Dashboard              โ
โ  /[en|fr]/client/api-access        โ API Integration Guide                 โ
โ                                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           ADMIN ROUTES (Private)                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                             โ
โ  /[en|fr]/dashboard                โ Admin Dashboard (All Leads)           โ
โ  /[en|fr]/dashboard/insights       โ Predictive Growth Insights            โ
โ  /[en|fr]/dashboard/clients        โ Client Management (Future)            โ
โ                                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                               API ROUTES                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                             โ
โ  POST /api/lead                    โ Submit Lead (Public/API Key)          โ
โ  POST /api/client/register         โ Create Client Account                 โ
โ  POST /api/client/auth             โ Client Login                          โ
โ  GET  /api/client/leads            โ Fetch Client Leads                    โ
โ  GET  /api/leads                   โ Fetch All Leads (Admin)               โ
โ  POST /api/auth-dashboard          โ Admin Authentication                  โ
โ                                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           DATA FLOW DIAGRAM                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   โโโโโโโโโโโโโโโ
   โ   CLIENT    โ
   โ  BUSINESS   โ
   โโโโโโโโฌโโโโโโโ
          โ
          โ 1. Signup
          โผ
   โโโโโโโโโโโโโโโโโโโ
   โ /client/signup  โ
   โโโโโโโโฌโโโโโโโโโโโ
          โ
          โ 2. POST /api/client/register
          โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  Generate API Key + Hash PW  โ
   โ  client_abc123...            โ
   โโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โ 3. Store in Database
          โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Supabase: clients table    โ
   โ   - id, client_id, api_key   โ
   โ   - business_name, email     โ
   โ   - password_hash, language  โ
   โโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โ 4. Send Welcome Email
          โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Gmail API (EN/FR)          โ
   โ   Contains: Dashboard URL    โ
   โ             API Key          โ
   โ             API Endpoint     โ
   โโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
          โ
          โ 5. Client Receives Credentials
          โ
          โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ                  CLIENT API INTEGRATION                      โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
   โ                                                              โ
   โ  Client System (CRM/Website)                                โ
   โ       โ                                                      โ
   โ       โ POST /api/lead                                      โ
   โ       โ Headers: x-api-key: client_abc123...               โ
   โ       โ Body: {name, email, message}                        โ
   โ       โผ                                                      โ
   โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                               โ
   โ  โ  API Key Validation     โ                               โ
   โ  โ  - Verify x-api-key     โ                               โ
   โ  โ  - Get client_id        โ                               โ
   โ  โ  - Update last_conn     โ                               โ
   โ  โโโโโโโโโโโโฌโโโโโโโโโโโโโโโ                               โ
   โ             โ                                                โ
   โ             โ Valid Key                                     โ
   โ             โผ                                                โ
   โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                               โ
   โ  โ   AI Enrichment         โ                               โ
   โ  โ   (GPT-4o-mini)         โ                               โ
   โ  โ   - Intent Analysis     โ                               โ
   โ  โ   - Tone Detection      โ                               โ
   โ  โ   - Urgency Level       โ                               โ
   โ  โ   - Confidence Score    โ                               โ
   โ  โโโโโโโโโโโโฌโโโโโโโโโโโโโโโ                               โ
   โ             โ                                                โ
   โ             โ Enriched Data                                 โ
   โ             โผ                                                โ
   โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                       โ
   โ  โ   Store in lead_memory          โ                       โ
   โ  โ   WITH client_id                โ                       โ
   โ  โ   - email, name, message        โ                       โ
   โ  โ   - ai_summary, intent, tone    โ                       โ
   โ  โ   - urgency, confidence_score   โ                       โ
   โ  โ   - client_id (from API key)    โ                       โ
   โ  โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ                       โ
   โ             โ                                                โ
   โ             โ Success                                       โ
   โ             โผ                                                โ
   โ        200 OK                                               โ
   โ                                                              โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           CLIENT DASHBOARD VIEW                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Client Logs In        โ
   โ   (email + password)    โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
               โ
               โ POST /api/client/auth
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Verify Credentials    โ
   โ   (bcrypt compare)      โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
               โ
               โ Valid
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ     /client/dashboard                        โ
   โ                                               โ
   โ  GET /api/client/leads?clientId=<uuid>      โ
   โ                                               โ
   โ  SELECT * FROM lead_memory                   โ
   โ  WHERE client_id = <current_client>         โ
   โ    AND deleted = false                       โ
   โ    AND archived = false                      โ
   โ  ORDER BY timestamp DESC                     โ
   โ                                               โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โ Display:
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  ๐ Stats:                                    โ
   โ     - Total Leads: 47                        โ
   โ     - Avg Confidence: 87%                    โ
   โ     - Top Intent: Partnership                โ
   โ     - High Urgency: 12                       โ
   โ                                               โ
   โ  ๐ Recent Leads Table:                      โ
   โ     Name | Email | Message | Intent | ...    โ
   โ     -----|-------|---------|--------|----     โ
   โ     John | j@... | I want...| Consul...      โ
   โ     Jane | j@... | Looking...| Partner...    โ
   โ                                               โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                            ADMIN DASHBOARD VIEW                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Admin Enters Password โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
               โ
               โ POST /api/auth-dashboard
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ   Verify Password       โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
               โ
               โ Valid
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ     /dashboard                                โ
   โ                                               โ
   โ  GET /api/leads?limit=100&locale=en          โ
   โ                                               โ
   โ  SELECT * FROM lead_memory                   โ
   โ  WHERE deleted = false                       โ
   โ    AND archived = false                      โ
   โ  ORDER BY timestamp DESC                     โ
   โ  LIMIT 100                                   โ
   โ                                               โ
   โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โ Display:
               โผ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  ๐ Global Stats (All Clients):               โ
   โ     - Total Leads: 1,247                     โ
   โ     - Avg Confidence: 83%                    โ
   โ     - Top Intent: Consultation               โ
   โ     - High Urgency: 89                       โ
   โ                                               โ
   โ  ๐ All Leads Table:                         โ
   โ     Name | Email | Intent | client_id | ...  โ
   โ     -----|-------|--------|-----------|----   โ
   โ     John | j@... | Consul...| abc123 |...    โ
   โ     Jane | j@... | Partner...| def456 |...   โ
   โ                                               โ
   โ  ๐ฏ Predictive Growth Engine                 โ
   โ  ๐ Relationship Insights                    โ
   โ  ๐ง Growth Copilot                           โ
   โ                                               โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           DATABASE SCHEMA                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   โโโโโโโโโโโโโโโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ     clients             โ         โ     lead_memory         โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโค         โโโโโโโโโโโโโโโโโโโโโโโโโโโค
   โ  id (UUID)              โ         โ  id (UUID)              โ
   โ  client_id (TEXT)       โโโโโโโโโโโ  client_id (TEXT)       โ
   โ  business_name (TEXT)   โ         โ  name (TEXT)            โ
   โ  contact_name (TEXT)    โ         โ  email (TEXT)           โ
   โ  email (TEXT)           โ         โ  message (TEXT)         โ
   โ  password_hash (TEXT)   โ         โ  ai_summary (TEXT)      โ
   โ  api_key (TEXT)         โ         โ  intent (TEXT)          โ
   โ  language (TEXT)        โ         โ  tone (TEXT)            โ
   โ  created_at (TIMESTAMPTZโ         โ  urgency (TEXT)         โ
   โ  last_login (TIMESTAMPTZโ         โ  confidence_score (FLOATโ
   โ  last_connection (TSTZ) โ         โ  timestamp (TIMESTAMPTZ)โ
   โ  is_active (BOOLEAN)    โ         โ  deleted (BOOLEAN)      โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ  archived (BOOLEAN)     โ
                                       โ  relationship_insight   โ
                                       โโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              SECURITY LAYERS                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   1. Password Security
      โโ bcrypt hashing (10 rounds)

   2. API Key Validation
      โโ x-api-key header required for external leads
      โโ Validated against clients table

   3. Data Isolation
      โโ RLS policies on clients table
      โโ Client dashboard: WHERE client_id = current_client
      โโ Admin dashboard: Full access

   4. Session Management
      โโ localStorage (client sessions)
      โโ Admin password in env (ADMIN_PASSWORD)

   5. Timestamps
      โโ last_login (client auth)
      โโ last_connection (API usage)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           BILINGUAL SUPPORT                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   Routes:
   โโ /en/* โ English
   โโ /fr/* โ Franรงais

   Translations:
   โโ Page labels, buttons, headings
   โโ Intent translation (FR โ EN)
   โโ Welcome emails (EN/FR)
   โโ Error messages
   โโ Dashboard stats labels

   AI Analysis:
   โโ Detects input language automatically
   โโ Generates summary in detected language
   โโ Intent/tone/urgency in appropriate language

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              COMPLETE FLOW                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

   1. Client Signup โ Account Created โ Email Sent
   2. Client Receives Welcome Email โ Credentials Provided
   3. Client Logs In โ Private Dashboard Accessed
   4. Client Integrates API โ Sends Leads via x-api-key
   5. Lead Processed โ AI Enrichment โ Stored with client_id
   6. Client Checks Dashboard โ Sees Only Their Leads
   7. Admin Checks Dashboard โ Sees All Leads (All Clients)

   โ Complete Isolation
   โ Secure Authentication
   โ Bilingual Throughout
   โ Professional UI
   โ Real-time AI Analysis
   โ Scalable Architecture

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              READY FOR PRODUCTION                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
